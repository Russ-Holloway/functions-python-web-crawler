╔════════════════════════════════════════════════════════════════════════════╗
║                   PHASE 1 DEPLOYMENT - QUICK START                         ║
╚════════════════════════════════════════════════════════════════════════════╝

📦 DEPLOYMENT PACKAGE
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
File:     phase1-deployment.zip
Size:     22.8 KB
Location: functions-python-web-crawler/functions-python-web-crawler/
Status:   ✅ READY TO DEPLOY

🚀 DEPLOYMENT COMMANDS (Copy & Paste into Azure CLI Bash)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# 1. Set your Azure resource details (from AZURE_RESOURCE_REFERENCE.md)
RESOURCE_GROUP="rg-btp-uks-prod-doc-mon-01"
FUNCTION_APP="func-btp-uks-prod-doc-crawler-01"
SUBSCRIPTION="96726562-1726-4984-88c6-2e4f28878873"
ZIP_FILE="phase1-deployment.zip"

# 2. Deploy to Azure
az functionapp deployment source config-zip \
  --resource-group $RESOURCE_GROUP \
  --name $FUNCTION_APP \
  --subscription $SUBSCRIPTION \
  --src $ZIP_FILE

# 3. Restart function app
az functionapp restart \
  --resource-group $RESOURCE_GROUP \
  --name $FUNCTION_APP

# 4. Stream logs to verify
az functionapp log tail \
  --resource-group $RESOURCE_GROUP \
  --name $FUNCTION_APP

✅ VERIFICATION COMMANDS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Check storage document count
STORAGE_ACCOUNT="stbtpuksprodcrawler01"
CONTAINER="documents"

az storage blob list \
  --account-name $STORAGE_ACCOUNT \
  --container-name $CONTAINER \
  --auth-mode login \
  --query "length([?name!='document-hashes.json' && name!='crawl_history.json'])" \
  --output tsv

# View dashboard
echo "https://$FUNCTION_APP.azurewebsites.net/api/dashboard"

📊 WHAT TO LOOK FOR AFTER DEPLOYMENT
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ Logs show: "✅ Uploaded uk-legislation/a1b2c3d4_data.pdf (original: data.pdf)"
✅ Storage count MATCHES "Documents Uploaded" in dashboard
✅ Virtual folders created in storage (college-of-policing/, cps/, etc.)
✅ No "filename collision" warnings
✅ Function app status: Running

⚠️  EXPECTED FIRST RUN BEHAVIOR
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

• First crawl may mark all documents as "new"
• Storage will reorganize into folder structure
• Document count will increase from 281 to actual count
• This is EXPECTED and CORRECT ✅

🎯 SUCCESS CRITERIA
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Documents Uploaded (dashboard) = Total Documents (storage) ✅

BEFORE:  2,810 uploaded → 281 in storage (90% LOSS) ❌
AFTER:   Y uploaded → Y in storage (100% MATCH) ✅

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Phase 1 Complete | Ready to Deploy | Zero Data Loss Expected
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
